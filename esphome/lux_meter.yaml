esphome:
  name: lux_meter
  platform: ESP8266
  board: d1_mini
  includes:
    - ClosedCube_OPT3001/ClosedCube_OPT3001.h
    - ClosedCube_OPT3001/ClosedCube_OPT3001.cpp
    - OPT3001.h

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_pass
  ap: #since we listed an SSID above, this AP mode will only enable if no WiFi connection could be made
    # FIXME to be incorporated into a common file
    ssid: OPT3001_AP
    password: !secret wifi_pass

captive_portal:

logger:

api:

ota:

web_server:

time:
  - platform: homeassistant
    id: esptime
    timezone: Europe/London

i2c:
  sda: GPIO4
  scl: GPIO5
  scan: True

sensor:
  - platform: custom
    lambda: |-
      auto opt3001 = new MyOPT3001();
      App.register_component(opt3001);
      return {opt3001->manufacturer_id_sensor, opt3001->device_id_sensor, opt3001->high_limit_sensor, opt3001->low_limit_sensor, opt3001->lux_sensor};

    sensors:
    - name: "Manufacturer ID"
    - name: "Device ID"
    - name: "Lux High Limit"
      unit_of_measurement: lx
    - name: "Lux Low Limit"
      unit_of_measurement: lx
    - name: "Lux Level"
      unit_of_measurement: lx
