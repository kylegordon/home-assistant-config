automation:
    - alias: Garden hallway light motion
      initial_state: true
      trigger:
        - platform: state
          entity_id: binary_sensor.garden_hall_motion
          to: 'on'
      condition:
        - condition: numeric_state
          entity_id: sensor.outside_utility_room_lightlevel
          below: 750
      action:
        - service: light.turn_on
          data_template:
            entity_id: group.hall
            brightness_pct: >
              {% if states('sensor.time_of_day') == "Morning" %}
              100
              {% elif states('sensor.time_of_day') == "Day" %}
              100
              {% elif states('sensor.time_of_day') == "Night" %}
              30
              {% endif %}
            transition: >
              {% if states('sensor.time_of_day') == "Morning" %}
              10
              {% elif states('sensor.time_of_day') == "Day" %}
              2
              {% elif states('sensor.time_of_day') == "Night" %}
              5
              {% endif %}
            color_temp: >
              {% if states('sensor.time_of_day') == "Morning" %}
              200
              {% elif states('sensor.time_of_day') == "Day" %}
              300
              {% elif states('sensor.time_of_day') == "Night" %}
              375
              {% endif %}
  
    - alias: Hallway motion - 10 minute timeout
      trigger:
      - platform: state
        entity_id: binary_sensor.garden_hall_motion
        to: 'off'
        for:
          minutes: 10
      action:
      - service: light.turn_off
        entity_id: group.hall
      - service: light.turn_off
        entity_id: light.garden_hall