group:
  christmas_lights:
    name: Christmas Lights
    entities:
      - light.christmas_tree
      - light.candle_arch
      - light.star_burst
      - light.christmas_star

automation:
  - alias: Outside decorations - on evening
    trigger:
      - platform: numeric_state
        entity_id: sensor.outside_utility_room_lightlevel
        below: 100
        for:
          minutes: 5
    condition:
      - condition: template
        value_template:  '{{ now().strftime("%m") == "12"
                          or
                          now().strftime("%m%d") <= 0106 }}'
    action:
      - service: homeassistant.turn_on
        entity_id: light.outside_decorations

  - alias: Outside decorations - on morning
    trigger:
      - platform: time
        at: "06:00:00"
    condition:
      - condition: template
        value_template: '{{ now().strftime("%m") == "12"
                         or
                         now().strftime("%m%d") <= 0106 }}'
    action:
      - service: homeassistant.turn_on
        entity_id: light.outside_decorations

  - alias: Outside decorations - off
    trigger:
      - platform: time
        at: "00:00:00"
      - platform: time
        at: "12:00:00"
      - platform: numeric_state
        entity_id: sensor.outside_utility_room_lightlevel
        above: 100
    action:
      - service: homeassistant.turn_off
        entity_id: light.outside_decorations

  - alias: Christmas decorations - on
    trigger:
      - platform: state
        entity_id: binary_sensor.home_occupied
        from: "off"
        to: "on"
      - platform: time
        at: "06:00:00"
    condition:
      - condition: template
        value_template: '{{ now().strftime("%m") == "12"
                         or
                         now().strftime("%m%d") <= 0106 }}'
    action:
      - service: homeassistant.turn_on
        entity_id: group.christmas_lights


  - alias: Christmas decorations - off
    trigger:
      - platform: state
        entity_id: binary_sensor.home_occupied
        from: "on"
        to: "off"
      - platform: time
        at: "00:00:00"
    condition:
      - condition: template
        value_template: '{{ now().strftime("%m") == "12"
                         or
                         now().strftime("%m%d") <= 0106 }}'
    action:
      - service: homeassistant.turn_off
        entity_id: group.christmas_lights
