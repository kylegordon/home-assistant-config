---
input_number:
  kitchen_light_level_trigger:
    name: Kitchen light level trigger
    icon: mdi:sun-angle-outline
    unit_of_measurement: lx
    min: 0
    max: 10000
    step: 1

automation:
  - alias: Kitchen motion
    trigger:
      platform: state
      entity_id: binary_sensor.kitchen_motion
      to: 'on'
    condition:
      - platform: numeric_state
        entity_id: sensor.average_external_light_level
        below: input_number.kitchen_light_level_trigger
        for:
          minutes: 10
    action:
      - service: homeassistant.turn_on
        data_template:
          entity_id:
            - light.kitchen_cabinets
            - light.kitchen

  - alias: Kitchen motion - 10 minute timeout
    trigger:
      platform: state
      entity_id: binary_sensor.kitchen_motion
      to: 'off'
      for:
        minutes: 10
    action:
      service: homeassistant.turn_off
      entity_id:
        - light.kitchen_cabinets
        - light.kitchen
