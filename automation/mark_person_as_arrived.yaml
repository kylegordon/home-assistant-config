alias: Mark Person as just arrived
trigger:
  - platform: state
    entity_id: device_tracker.bagpuss_a0001
    from: 'not_home'
    to: 'home'
  - platform: state
    entity_id: device_tracker.charlotte_thea
    from: 'not_home'
    to: 'home'
action:
  - service: input_select.select_option
    data_template:
      entity_id: >
        {% if trigger.entity_id == 'device_tracker.bagpuss_a0001' %}
          input_select.kyle_status_dropdown
        {% elif trigger.entity_id == 'device_tracker.charlotte_thea' %}
          input_select.charlotte_status_dropdown
        {% endif %}
      option: Just Arrived

  - service: notify.email_kyle
    data_template:
      message: >
        {% if trigger.entity_id == 'device_tracker.bagpuss_a0001' %}
          Kyle has just arrived.
        {% elif trigger.entity_id == 'device_tracker.charlotte_thea' %}
          Charlotte has just arrived.
        {% endif %}

  - service: script.tweet_engine
    data_template:
      tweet: >
        {{ [ 
        "Yay! Company!",
        "A resident has just arrived!"
         ] | random + " http://amzn.to/2D3J8jW" }}

  - service: notify.twitter_thegordonhome
    data:
      message: "A resident has just arrived!"

